import{r,j as h}from"./vendor-react-CzGZ0ZUq.js";const k=r.createContext(void 0),C=()=>{const a=r.useContext(k);if(a===void 0)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return a},p=({children:a})=>{const[n,c]=r.useState(null),[g,d]=r.useState(null),[i,l]=r.useState(!0),[u,m]=r.useState(null);r.useEffect(()=>{const t=localStorage.getItem("auth_token"),e=localStorage.getItem("auth_user");t&&e&&(d(t),c(JSON.parse(e))),l(!1)},[]);const f={user:n,token:g,isAuthenticated:!!n,isLoading:i,login:async(t,e)=>{l(!0),m(null);try{if(await new Promise(o=>setTimeout(o,1e3)),t==="admin@restaurante.com"&&e==="admin123"){const o={id:1,nombre:"Admin",apellido:"Sistema",email:"admin@restaurante.com",rol:"admin"},s="fake_jwt_token_"+Math.random().toString(36).substring(2);localStorage.setItem("auth_token",s),localStorage.setItem("auth_user",JSON.stringify(o)),c(o),d(s)}else if(t==="cliente@gmail.com"&&e==="cliente123"){const o={id:2,nombre:"Cliente",apellido:"Ejemplo",email:"cliente@gmail.com",rol:"cliente"},s="fake_jwt_token_"+Math.random().toString(36).substring(2);localStorage.setItem("auth_token",s),localStorage.setItem("auth_user",JSON.stringify(o)),c(o),d(s)}else throw new Error("Credenciales inválidas")}catch(o){o instanceof Error?m(o.message):m("Error al iniciar sesión")}finally{l(!1)}},logout:()=>{localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),c(null),d(null)},error:u};return h.jsx(k.Provider,{value:f,children:a})},w=r.createContext(void 0),E=()=>{const a=r.useContext(w);if(a===void 0)throw new Error("useCart debe ser usado dentro de un CartProvider");return a},_=({children:a})=>{const[n,c]=r.useState([]);r.useEffect(()=>{const t=localStorage.getItem("shopping_cart");if(t)try{c(JSON.parse(t))}catch(e){console.error("Error al cargar el carrito:",e),localStorage.removeItem("shopping_cart")}},[]),r.useEffect(()=>{localStorage.setItem("shopping_cart",JSON.stringify(n))},[n]);const g=t=>{c(e=>{const o=e.findIndex(s=>s.id===t.id);if(o>=0){const s=[...e];return s[o].cantidad+=1,s}else return[...e,{...t,cantidad:1}]})},d=t=>{c(e=>e.filter(o=>o.id!==t))},i=(t,e)=>{if(e<=0){d(t);return}c(o=>o.map(s=>s.id===t?{...s,cantidad:e}:s))},l=()=>{c([])},u=()=>n.reduce((t,e)=>t+e.precio*e.cantidad,0),m=()=>u()*.19,S=()=>u()+m(),v=n.reduce((t,e)=>t+e.cantidad,0),f={items:n,addItem:g,removeItem:d,updateQuantity:i,clearCart:l,getSubtotal:u,getTotal:S,getIVA:m,itemsCount:v};return h.jsx(w.Provider,{value:f,children:a})},I=r.createContext(void 0);function T({children:a}){const[n,c]=r.useState(()=>{if(typeof window>"u")return!1;const i=localStorage.getItem("theme");return i?i==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches});r.useEffect(()=>{if(typeof window>"u")return;const i=window.document.documentElement;console.log("Cambiando tema a:",n?"dark":"light"),n?(i.classList.add("dark"),localStorage.setItem("theme","dark")):(i.classList.remove("dark"),localStorage.setItem("theme","light"))},[n]),r.useEffect(()=>{if(typeof window>"u")return;const i=window.matchMedia("(prefers-color-scheme: dark)"),l=u=>{localStorage.getItem("theme")||c(u.matches)};return i.addEventListener("change",l),()=>{i.removeEventListener("change",l)}},[]);const d={isDarkMode:n,toggleTheme:()=>{console.log("Toggle theme llamado, cambiando de",n,"a",!n),c(!n)}};return h.jsx(I.Provider,{value:d,children:a})}function b(){const a=r.useContext(I);if(a===void 0)throw new Error("useTheme debe ser usado dentro de un ThemeProvider");return a}export{p as A,_ as C,T,C as a,E as b,b as u};
